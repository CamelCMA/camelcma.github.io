---
layout: post
title: VDOC-04 Executable Wrapper
categories:
  - Cae
tags:
  - Cae
  - Vrand
  - VisualDOC
  - VDOC
  - Optimization
  - Python
excerpt: "應用VisualDOC內建Executable Wrapper連接本機Python環境，進行函數最小化求解。<br/>"
---

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true" style="position: relative;"><h2 id="-0-目錄"><a class="anchor hidden-xs" href="#-0-目錄" title="-0-目錄"><span class="octicon octicon-link"></span></a><img alt=":bulb:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/bulb.png" title=":bulb:"> 0. 目錄</h2><p><span class="toc"><ul>
<li><a href="#VDOC_04_Executable_Wrapper" title="VDOC_04_Executable_Wrapper">VDOC_04_Executable_Wrapper</a><ul>
<li><a href="#-0-目錄" title=" 0. 目錄"> 0. 目錄</a></li>
<li><a href="#-1-老駱提醒" title=" 1. 老駱提醒"> 1. 老駱提醒</a></li>
<li><a href="#-2-問題描述" title=" 2. 問題描述"> 2. 問題描述</a></li>
<li><a href="#-3-Executable-Wrapper的妙用" title=" 3. Executable Wrapper的妙用"> 3. Executable Wrapper的妙用</a><ul>
<li><a href="#31-Work-Flow" title="3.1 Work Flow">3.1 Work Flow</a></li>
<li><a href="#32-Component-Editor內層" title="3.2 Component Editor內層">3.2 Component Editor內層</a></li>
<li><a href="#33-Data-Linker" title="3.3 Data Linker">3.3 Data Linker</a></li>
<li><a href="#34-Component-Editor內層" title="3.4 Component Editor內層">3.4 Component Editor內層</a></li>
<li><a href="#35-Simulation-Monitors" title="3.5 Simulation Monitors">3.5 Simulation Monitors</a></li>
<li><a href="#36-Post-Processing" title="3.6 Post Processing">3.6 Post Processing</a></li>
</ul>
</li>
<li><a href="#-4-聯絡老駱" title="  4. 聯絡老駱">  4. 聯絡老駱</a></li>
</ul>
</li>
</ul>
</span></p>

<h2 id="-1-老駱提醒"><a class="anchor hidden-xs" href="#-1-老駱提醒" title="-1-老駱提醒"><span class="octicon octicon-link"></span></a><img alt=":mega:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/mega.png" title=":mega:"> 1. 老駱提醒</h2><div class="alert alert-info">
<ul>
<li>請先確認，您已經閱讀 <ins><a href="{% post_url 2019-12-17-VDOC_00_Introduction %}" target="_blank" rel="noopener">VDOC_00_Introduction</a></ins> 中的聲明。</li>
<li>本文說明如何利用<code>VisualDOC</code>內的<code>Executable Wrapper</code>連接您本機的<code>Python</code>環境。</li>
</ul>
</div><h2 id="-2-問題描述"><a class="anchor hidden-xs" href="#-2-問題描述" title="-2-問題描述"><span class="octicon octicon-link"></span></a><img alt=":question:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/question.png" title=":question:"> 2. 問題描述</h2><p>Minimize <code>Objective Function</code> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 3.343em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.858em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.75em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">f(x,y)</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mfrac><mrow><mo stretchy=&quot;false&quot;>(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mn>10</mn></mfrac></mrow><mo>&amp;#x2212;</mo><mi>cos</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mi>cos</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 17.567em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.143em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.649em, 1015.03em, 3.235em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="texatom" id="MathJax-Span-18" style="padding-left: 0.272em;"><span class="mrow" id="MathJax-Span-19"><span class="mfrac" id="MathJax-Span-20"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.02em, 1003.88em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.991em;"><span class="mrow" id="MathJax-Span-21"><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.595em;"><span class="mn" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="msubsup" id="MathJax-Span-27" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.362em; left: 0.541em;"><span class="mn" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.97em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.482em;"><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1004.1em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.098em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main; padding-left: 0.218em;">−</span><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.218em;">cos</span><span class="mo" id="MathJax-Span-34"></span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.164em;">cos</span><span class="mo" id="MathJax-Span-39"></span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mfrac><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><mn>10</mn></mfrac></mrow><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">
f(x,y) = {(x^2 + y^2) \over 10} - \cos(x)\cos(y)
</script></span></p><p>Subject to the <code>Constraint Equation</code> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 3.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.751em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1002.64em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">g(x,y)</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2265;</mo><mn>1.5</mn></math>" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-51" style="width: 12.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.671em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.35em, 1010.62em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.272em;">(</span><span class="msubsup" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 1.026em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.595em;"><span class="mn" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="msubsup" id="MathJax-Span-65" style="padding-left: 0.218em;"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.541em;"><span class="mn" id="MathJax-Span-67" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.272em;">≥</span><span class="mn" id="MathJax-Span-70" style="font-family: MathJax_Main; padding-left: 0.272em;">1.5</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo>≥</mo><mn>1.5</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">
g(x,y) = (x^2 + y^2) \ge 1.5
</script></span></p><p><code>Design Variables (Side Constraints)</code>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo>&amp;#x2212;</mo><mn>2</mn><mo>&amp;#x2264;</mo><mi>x</mi><mo>&amp;#x2264;</mo><mn>2</mn><mspace linebreak=&quot;newline&quot; /><mo>&amp;#x2212;</mo><mn>2</mn><mo>&amp;#x2264;</mo><mi>y</mi><mo>&amp;#x2264;</mo><mn>4</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 100%; display: inline-block; min-width: 5.929em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(3.182em, 1005.12em, 5.606em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-72"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1004.96em, 4.313em, -999.997em); top: -3.984em; left: 50%; margin-left: -2.476em;"><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-74" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main; padding-left: 0.272em;">≤</span><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">x</span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.272em;">≤</span><span class="mn" id="MathJax-Span-78" style="font-family: MathJax_Main; padding-left: 0.272em;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1005.12em, 4.367em, -999.997em); top: -2.745em; left: 50%; margin-left: -2.584em;"><span class="mspace" id="MathJax-Span-79" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.218em;">2</span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main; padding-left: 0.272em;">≤</span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.272em;">≤</span><span class="mn" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.272em;">4</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 2.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>−</mo><mn>2</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mn>2</mn><mspace linebreak="newline"></mspace><mo>−</mo><mn>2</mn><mo>≤</mo><mi>y</mi><mo>≤</mo><mn>4</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">
-2\le x\le2\\
-2\le y\le4
</script></span></p><p><code>Initial Conditions</code>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>x</mi><mo>=</mo><mn>2</mn><mspace linebreak=&quot;newline&quot; /><mi>y</mi><mo>=</mo><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" style="width: 100%; display: inline-block; min-width: 2.751em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(3.182em, 1002.32em, 5.552em, -999.997em); top: -3.984em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-87"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1002.32em, 4.151em, -999.997em); top: -3.984em; left: 50%; margin-left: -1.183em;"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.272em;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1002.27em, 4.367em, -999.997em); top: -2.799em; left: 50%; margin-left: -1.183em;"><span class="mspace" id="MathJax-Span-91" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.272em;">2</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.684em; border-left: 0px solid; width: 0px; height: 2.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mn>2</mn><mspace linebreak="newline"></mspace><mi>y</mi><mo>=</mo><mn>2</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">
x=2\\
y=2
</script></span></p><h2 id="-3-Executable-Wrapper的妙用"><a class="anchor hidden-xs" href="#-3-Executable-Wrapper的妙用" title="-3-Executable-Wrapper的妙用"><span class="octicon octicon-link"></span></a><img alt=":battery:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/battery.png" title=":battery:"> 3. Executable Wrapper的妙用</h2><p>由於<code>VisualDOC</code>於內部介面使用<a href="https://zh.wikipedia.org/zh-tw/Jython" target="_blank" rel="noopener">Jython</a>，故其內建<code>Python</code>語法僅支援到<code>Python2.x</code>版本，但使用者仍可以使用<code>Executable Wrapper</code>連接本機的<code>Python3.x</code>環境甚至其它<code>Executable File</code>使用。</p><h3 id="31-Work-Flow"><a class="anchor hidden-xs" href="#31-Work-Flow" title="31-Work-Flow"><span class="octicon octicon-link"></span></a>3.1 Work Flow</h3><p>打開<code>Opt Using PythonEquation</code> <code>task</code>，另存一個新的<code>task</code>，命名為<code>Opt Using localPython</code>，並刪除<code>PythonEquation</code> <code>component</code>。</p><p><img src="/assets/img/vrand_vdoc/ch4/101_work_flow.jpg" alt="101_work_flow"></p><p>接著至<code>E欄</code>中將<code>Executable Wrapper</code> <code>component</code>拖曳至<code>Optimization</code> <code>component</code>中。</p><div class="alert alert-warning">
<p><img alt=":flashlight:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/flashlight.png" title=":flashlight:"> 要注意請選擇<code>Executable Wrapper</code> <code>component</code>，不是<code>Executable</code> <code>component</code>喔!</p>
</div><p><img src="/assets/img/vrand_vdoc/ch4/102_work_flow.jpg" alt="102_work_flow"></p><p>重新連接<code>Work Flow</code>。</p><p><img src="/assets/img/vrand_vdoc/ch4/103_work_flow.jpg" alt="103_work_flow"></p><h3 id="32-Component-Editor內層"><a class="anchor hidden-xs" href="#32-Component-Editor內層" title="32-Component-Editor內層"><span class="octicon octicon-link"></span></a>3.2 Component Editor內層</h3><p>建立<code>1</code>個<code>.txt</code>檔案，命名為<code>input.txt</code>，在第<code>1</code>行及第<code>2</code>行都輸入<code>2.0</code>，來代表<code>x</code>及<code>y</code>的<code>Initial Value</code>。</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span></div><div class="code"><span class="hljs-number">2.0</span>
<span class="hljs-number">2.0</span>
</div></div></code></pre><p>建立<code>1</code>個空的<code>.txt</code>檔案，命名為<code>output.txt</code>。</p><p>建立<code>1</code>個<code>.py</code>檔案，命名為<code>Equation.py</code>，輸入以下程式碼。</p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span></div><div class="code"><span class="hljs-keyword">import</span> math

<span class="hljs-comment"># Read variables</span>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">'input.txt'</span>) <span class="hljs-keyword">as</span> file:
    ipt = [float(line) <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file]

<span class="hljs-comment"># Unpack variables to x and y</span>
x, y = ipt

<span class="hljs-comment"># Response evaluation</span>
f = (x**<span class="hljs-number">2</span> + y**<span class="hljs-number">2</span>) / <span class="hljs-number">10</span> - math.cos(x) * math.cos(y)
g = x**<span class="hljs-number">2</span> + y**<span class="hljs-number">2</span>

<span class="hljs-comment"># Output responses</span>
<span class="hljs-keyword">with</span> open(<span class="hljs-string">'output.txt'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> file:
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> (f, g):
        file.write(<span class="hljs-string">'{:28.16e}'</span>.format(line) + <span class="hljs-string">'\n'</span>)

</div></div></code></pre><div class="alert alert-warning">
<p><img alt=":flashlight:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/flashlight.png" title=":flashlight:"> 使用<code>Executable Wrapper</code>，必須自己處理<code>I/O</code>介面，雖然比較麻煩，但是對於複雜的<code>I/O</code>文件，可以有很好的控制權。此外，由於已經接到了本機的<code>Python</code>環境，所以這表示可以自由<code>import</code>其它模組來運用，像是<code>pandas</code>、<code>numpy</code>、<code>scipy</code>等等，後續可以做相當多的運用。</p>
</div><p>點選<code>C欄</code> <code>Component Editor</code>內的<code>Executable Wrapper</code> <code>component</code>，於右方欄位進行下列設定:</p><ul>
<li>在<code>Local Analysis Program Definition</code>中選擇<code>Python</code>的執行方法。老駱自己是習慣用環境變數，所以打了<code>Python</code>。此外也可以直接用路徑來指定。舉例來說，例如想用<code>Anaconda</code>下<code>1</code>個名叫<code>VisualDOC</code>的虛擬環境來執行的話，可以將<code>Fie Path Type</code>設為<code>Absolute</code>，並於<code>File Path</code>輸入<code>C:\Users\您的使用者名稱\Anaconda3\envs\VisualDOC\python.exe</code>。</li>
<li>在<code>Analysis options</code> 裡的<code>Program Arguments</code>內輸入<code>Equation.py</code>。</li>
<li>在<code>Input File Definition</code>的<code>File Path</code>選擇<code>input.txt</code>。</li>
<li>在<code>Output File Definition</code>的<code>File Path</code>選擇<code>Output.txt</code>。</li>
</ul><p>輸入完成後，右方的欄位應該會像:<br>
<img src="/assets/img/vrand_vdoc/ch4/201_component_editor.jpg" alt="201_component_editor"></p><p>點選左方欄位，進行下列設定:</p><ul>
<li>輸入<code>x</code>、<code>y</code>、<code>f</code>及<code>g</code>。</li>
<li>將<code>x</code>及<code>y</code>的<code>Input/Output</code>設定為<code>input</code>。</li>
<li>將<code>f</code>及<code>g</code>的<code>Input/Output</code>設定為<code>output</code>。</li>
</ul><p>如 <ins><a href="{% post_url 2019-12-17-VDOC_01_PythonEquation %}" target="_blank" rel="noopener">VDOC_01_PythonEquation</a></ins> 所述，其實不一定要指定<code>x</code>及<code>y</code>的<code>Initial Value</code>，但如果指定的話，將有助於確認與本機<code>Python</code>環境是否正確設定。事實上，如果不指定此處<code>x</code>及<code>y</code>的<code>Initial Value</code>，<code>VisualDOC</code>還是能正常執行。</p><p>輸入完成後，左方的欄位應該會像:<br>
<img src="/assets/img/vrand_vdoc/ch4/202_component_editor.jpg" alt="202_component_editor"></p><h3 id="33-Data-Linker"><a class="anchor hidden-xs" href="#33-Data-Linker" title="33-Data-Linker"><span class="octicon octicon-link"></span></a>3.3 Data Linker</h3><p>點選<code>C欄</code>中的<code>Data Linker</code>，使用<code>Automatically add data to the selected model</code>來自動連接。</p><p><img src="/assets/img/vrand_vdoc/ch4/301_data_linker.jpg" alt="301_data_linker"></p><p>接下來點選<code>C欄</code>中的<code>component editor外層</code>的<code>Optimization</code> <code>component</code>，變數已經新增好了。</p><h3 id="34-Component-Editor內層"><a class="anchor hidden-xs" href="#34-Component-Editor內層" title="34-Component-Editor內層"><span class="octicon octicon-link"></span></a>3.4 Component Editor內層</h3><p>點選<code>C欄</code> <code>Component Editor</code>內的<code>Optimization</code> <code>component</code>，進行下列設定:</p><ul>
<li>設定<code>x</code>的<code>Lower Bound</code>為<code>-2</code>及<code>Upper Bound</code>為<code>2</code>。</li>
<li>設定<code>y</code>的<code>Lower Bound</code>為<code>-2</code>及<code>Upper Bound</code>為<code>4</code>。</li>
<li>勾選<code>f</code>為<code>Objective</code>、不勾選其為<code>Constraint</code>，並確定其<code>Goal</code>維持預設的<code>Minimize</code>。</li>
<li>勾選<code>g</code>為<code>Constraint</code>，並設定其<code>Lower Bound</code>為<code>1.5</code>。</li>
</ul><p><img src="/assets/img/vrand_vdoc/ch4/203_component_editor.jpg" alt="203_component_editor"></p><p>右邊的演算法部份，維持預設。</p><p><img src="/assets/img/vrand_vdoc/ch4/204_component_editor.jpg" alt="204_component_editor"></p><h3 id="35-Simulation-Monitors"><a class="anchor hidden-xs" href="#35-Simulation-Monitors" title="35-Simulation-Monitors"><span class="octicon octicon-link"></span></a>3.5 Simulation Monitors</h3><p>選擇最常用的<code>BestObjetive</code>及<code>WrostConstraint</code>來觀察。</p><p><img src="/assets/img/vrand_vdoc/ch4/401_simulation_monitors.jpg" alt="401_simulation_monitors"></p><h3 id="36-Post-Processing"><a class="anchor hidden-xs" href="#36-Post-Processing" title="36-Post-Processing"><span class="octicon octicon-link"></span></a>3.6 Post Processing</h3><p><img src="/assets/img/vrand_vdoc/ch4/501_post_processing.jpg" alt="501_post_processing"></p><p><img src="/assets/img/vrand_vdoc/ch4/502_post_processing.jpg" alt="502_post_processing"></p><p><img src="/assets/img/vrand_vdoc/ch4/503_post_processing.jpg" alt="503_post_processing"></p><table>
<thead>
<tr>
<th style="text-align:center">()內為<code>PythonEquation</code>被呼叫次數</th>
<th style="text-align:center"><code>x</code></th>
<th style="text-align:center"><code>y</code></th>
<th style="text-align:center"><code>f</code></th>
<th style="text-align:center"><code>g</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>Opt Using PythonEquation(48)</code></td>
<td style="text-align:center">0.86087</td>
<td style="text-align:center">0.87115</td>
<td style="text-align:center">-0.26971</td>
<td style="text-align:center">1.50000</td>
</tr>
<tr>
<td style="text-align:center"><code>Opt Using DOE(9)</code></td>
<td style="text-align:center">2.00000</td>
<td style="text-align:center">0.29777</td>
<td style="text-align:center">-0.07096</td>
<td style="text-align:center">4.08891</td>
</tr>
<tr>
<td style="text-align:center"><code>Opt Using DOE(Verified by PythonEquation)(40)</code></td>
<td style="text-align:center">2.00000</td>
<td style="text-align:center">0.29777</td>
<td style="text-align:center">-0.07096</td>
<td style="text-align:center">4.08891</td>
</tr>
<tr>
<td style="text-align:center"><code>RSA Using DOE(33)</code></td>
<td style="text-align:center">0.86787</td>
<td style="text-align:center">0.86306</td>
<td style="text-align:center">-0.26985</td>
<td style="text-align:center">1.49966</td>
</tr>
<tr>
<td style="text-align:center"><code>Opt Using localPython(48)</code></td>
<td style="text-align:center">0.86087</td>
<td style="text-align:center">0.87115</td>
<td style="text-align:center">-0.26971</td>
<td style="text-align:center">1.50001</td>
</tr>
</tbody>
</table><p>可以看出來，求解結果與<code>Opt Using PythonEquation</code>一致。</p><h2 id="-4-聯絡老駱"><a class="anchor hidden-xs" href="#-4-聯絡老駱" title="-4-聯絡老駱"><span class="octicon octicon-link"></span></a><img alt=":mailbox:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/mailbox.png" title=":mailbox:">  4. 聯絡老駱</h2><div class="alert alert-info">
<p>如果您或貴單位:</p>
<ul>
<li>有導入<code>VR&amp;D</code>產品的意願，但是有報價、採購及發票等問題。</li>
<li>有教育訓練或顧問需求。</li>
<li>有些建言指教。</li>
<li>想交個朋友。<br>
歡迎透過 <img alt=":camel:" class="emoji" src="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/images/basic/camel.png" title=":camel:"> <ins><a href="mailto:camel@caeml.ai" target="_blank" rel="noopener">camel@caeml.ai</a></ins> 聯絡老駱。</li>
</ul>
</div>
</div>
</body>
